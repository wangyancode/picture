/* Codestar Framework | A Simple and Lightweight WordPress Option Framework - v2.3.0*/

"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e,t,i,n){var a=a||{};a.funcs={},a.vars={onloaded:!1,$body:e("body"),$window:e(t),$document:e(i),$form_warning:null,is_confirm:!1,form_modified:!1,code_themes:[],is_rtl:e("body").hasClass("rtl")},a.helper={uid:function(e){return(e||"")+Math.random().toString(36).substr(2,9)},preg_quote:function(e){return(e+"").replace(/(\[|\])/g,"\\$1")},name_nested_replace:function(t,i){var n=new RegExp(a.helper.preg_quote(i+"[\\d+]"),"g");t.find(":radio").each(function(){(this.checked||this.orginal_checked)&&(this.orginal_checked=!0)}),t.each(function(t){e(this).find(":input").each(function(){this.name=this.name.replace(n,i+"["+t+"]"),this.orginal_checked&&(this.checked=!0)})})},debounce:function(e,t,i){var n;return function(){var a=this,c=arguments,o=function(){n=null,i||e.apply(a,c)},s=i&&!n;clearTimeout(n),n=setTimeout(o,t),s&&e.apply(a,c)}}},e.fn.iocf_clone=function(){for(var t=e.fn.clone.apply(this,arguments),i=this.find("select").add(this.filter("select")),n=t.find("select").add(t.filter("select")),a=0;a<i.length;++a)for(var c=0;c<i[a].options.length;++c)!0===i[a].options[c].selected&&(n[a].options[c].selected=!0);return this.find(":radio").each(function(){this.orginal_checked=this.checked}),t},e.fn.iocf_expand_all=function(){return this.each(function(){e(this).on("click",function(t){t.preventDefault(),e(".csf-wrapper").toggleClass("csf-show-all"),e(".csf-section").iocf_reload_script(),e(this).find(".fa").toggleClass("fa-indent").toggleClass("fa-outdent");var i=e(".csf-wrapper");if(i.hasClass("csf-search-all")){var n=i.find(".csf-section > .csf-field:not(.csf-depend-on)");e(".csf-search input").val(""),i.removeClass("csf-search-all"),n.removeClass("csf-metabox-hide")}})})},e.fn.iocf_nav_options=function(){return this.each(function(){var i,n=e(this),a=e(t),c=e("#wpwrap"),o=n.find("a");a.on("hashchange csf.hashchange",function(){var n=t.location.hash.replace("#tab=",""),a=n||o.first().attr("href").replace("#tab=",""),s=e('[data-tab-id="'+a+'"]');if(s.length){s.closest(".csf-tab-item").addClass("csf-tab-expanded").siblings().removeClass("csf-tab-expanded"),s.next().is("ul")&&(s=s.next().find("li").first().find("a"),a=s.data("tab-id")),o.removeClass("csf-active"),s.addClass("csf-active"),i&&i.addClass("hidden");var r=e('[data-section-id="'+a+'"]');r.removeClass("hidden"),r.iocf_reload_script(),e(".csf-section-id").val(r.index()+1),i=r,c.hasClass("wp-responsive-open")&&(e("html, body").animate({scrollTop:r.offset().top-50},200),c.removeClass("wp-responsive-open"));var f=e(".csf-wrapper");f.hasClass("csf-show-all")&&f.removeClass("csf-show-all")}}).trigger("csf.hashchange")})},e.fn.iocf_nav_metabox=function(){return this.each(function(){var t,i=e(this),n=i.find("a"),a=i.parent().find(".csf-section");n.each(function(i){e(this).on("click",function(c){c.preventDefault();var o=e(this);n.removeClass("csf-active"),o.addClass("csf-active"),void 0!==t&&t.addClass("hidden");var s=a.eq(i);s.removeClass("hidden"),s.iocf_reload_script(),t=s})}),n.first().trigger("click")})},e.fn.iocf_page_templates=function(){this.length&&e(i).on("change",".editor-page-attributes__template select, #page_template, .edit-post-post-status + div select",function(){var t=e(this).val()||"default";e(".csf-page-templates").removeClass("csf-metabox-show").addClass("csf-metabox-hide"),e(".csf-page-"+t.toLowerCase().replace(/[^a-zA-Z0-9]+/g,"-")).removeClass("csf-metabox-hide").addClass("csf-metabox-show")})},e.fn.iocf_post_formats=function(){this.length&&e(i).on("change",'.editor-post-format select, #formatdiv input[name="post_format"]',function(){var t=e(this).val()||"default";t="0"===t?"default":t,e(".csf-post-formats").removeClass("csf-metabox-show").addClass("csf-metabox-hide"),e(".csf-post-format-"+t).removeClass("csf-metabox-hide").addClass("csf-metabox-show")})},e.fn.iocf_search=function(){return this.each(function(){e(this).find("input").on("change keyup",function(){var i=e(this).val(),n=e(".csf-wrapper"),a=n.find(".csf-section"),c=a.find("> .csf-field:not(.csf-depend-on)"),o=c.find("> .csf-title, .csf-search-tags");i.length>1?(c.addClass("csf-metabox-hide"),n.addClass("csf-search-all"),o.each(function(){var n=e(this);if(n.text().match(new RegExp(".*?"+i+".*?","i"))){var a=n.closest(".csf-field");a.removeClass("csf-metabox-hide"),a.parent().iocf_reload_script();var c=a.parent().data("section-id"),o=t.location.href.split("#tab")[0]+"#tab="+c,s="<p class='search-list-name'><b>目录</b><a href='"+o+"' target='_blank'>"+decodeURIComponent(c)+" <i class='fa fa-angle-right' aria-hidden='true'></i></a></p>";a.find(".search-list-name")[0]||a.prepend(s)}})):(e(".search-list-name").remove(),c.removeClass("csf-metabox-hide"),n.removeClass("csf-search-all"))})})},e.fn.iocf_sticky=function(){return this.each(function(){var i=e(this),n=e(t),a=i.find(".csf-header-inner"),c=parseInt(a.css("padding-left"))+parseInt(a.css("padding-right")),o=0,s=!1,r=function(){var e=i.offset().top,t=Math.max(32,e-o),s=n.innerWidth();t<=32&&s>782?(a.css({width:i.outerWidth()-c}),i.css({height:i.outerHeight()}).addClass("csf-sticky")):(a.removeAttr("style"),i.removeAttr("style").removeClass("csf-sticky"))},f=function(){s||requestAnimationFrame(function(){r(),s=!1}),s=!0},l=function(){o=n.scrollTop(),f()};n.on("scroll resize",l),l()})},e.fn.iocf_dependency=function(){return this.each(function(){var t=e(this),i=t.children("[data-controller]");if(i.length){var n=e.iocf_deps.createRuleset(),c=e.iocf_deps.createRuleset(),o=e.iocf_deps.createRuleset(),s=[],r=[],f=[];if(i.each(function(){var t=e(this),i=t.data("controller").split("|"),a=t.data("condition").split("|"),l=t.data("value").toString().split("|"),d=t.data("depend-global")?t.data("depend-global").toString().split("|"):"",h=!!t.data("depend-global"),p=h?c:n,u=h;e.each(i,function(e,i){var c=l[e]||"",v=a[e]||a[0];"group"==d[e]?u||(p=o,u=!0):""==d[e]&&u&&(p=n,u=!1),p=p.createRule('[data-depend-id="'+i+'"]',v,c),p.include(t),"group"==d[e]?f.push(i):""==d[e]?s.push(i):h?r.push(i):s.push(i)})}),s.length&&e.iocf_deps.enable(t,n,s),f.length){var l=t.closest(".csf-cloneable-item");0==l.length&&(l=t.closest(".group")),e.iocf_deps.enable(l,c,f)}r.length&&e.iocf_deps.enable(a.vars.$body,c,r)}})},e.fn.iocf_field_accordion=function(){return this.each(function(){e(this).find(".csf-accordion-title").on("click",function(){var t=e(this),i=t.find(".csf-accordion-icon"),n=t.next();i.hasClass("fa-angle-right")?i.removeClass("fa-angle-right").addClass("fa-angle-down"):i.removeClass("fa-angle-down").addClass("fa-angle-right"),n.data("opened")||(n.iocf_reload_script(),n.data("opened",!0)),n.toggleClass("csf-accordion-open")})})},e.fn.iocf_field_backup=function(){return this.each(function(){if(void 0!==t.wp.customize){var i=this,n=e(this),c=(e("body"),n.find(".csf-import")),o=n.find(".csf-reset");i.notificationOverlay=function(){wp.customize.notifications&&wp.customize.OverlayNotification&&(wp.customize.state("saved").get()||(wp.customize.state("changesetStatus").set("trash"),wp.customize.each(function(e){e._dirty=!1}),wp.customize.state("saved").set(!0)),wp.customize.notifications.add(new wp.customize.OverlayNotification("iocf_field_backup_notification",{type:"default",message:"&nbsp;",loading:!0})))},o.on("click",function(e){e.preventDefault(),a.vars.is_confirm&&(i.notificationOverlay(),t.wp.ajax.post("csf-reset",{unique:o.data("unique"),nonce:o.data("nonce")}).done(function(e){t.location.reload(!0)}).fail(function(e){alert(e.error),wp.customize.notifications.remove("iocf_field_backup_notification")}))}),c.on("click",function(e){e.preventDefault(),a.vars.is_confirm&&(i.notificationOverlay(),t.wp.ajax.post("csf-import",{unique:c.data("unique"),nonce:c.data("nonce"),data:n.find(".csf-import-data").val()}).done(function(e){t.location.reload(!0)}).fail(function(e){alert(e.error),wp.customize.notifications.remove("iocf_field_backup_notification")}))})}})},e.fn.iocf_field_background=function(){return this.each(function(){e(this).find(".csf--background-image").iocf_reload_script()})},e.fn.iocf_field_code_editor=function(){return this.each(function(){if("function"==typeof CodeMirror){var t=e(this),i=t.find("textarea"),n=t.find(".CodeMirror"),c=i.data("config");n.length&&n.remove();var o=setInterval(function(){if(t.is(":visible")){var n=CodeMirror.fromTextArea(i[0],c);if("default"!==c.theme&&-1===a.vars.code_themes.indexOf(c.theme)){var s=e("<link>");e("#csf-codemirror-css").after(s),s.attr({rel:"stylesheet",id:"csf-codemirror-"+c.theme+"-css",href:c.cdnURL+"/theme/"+c.theme+".min.css",type:"text/css",media:"all"}),a.vars.code_themes.push(c.theme)}CodeMirror.modeURL=c.cdnURL+"/mode/%N/%N.min.js",CodeMirror.autoLoadMode(n,c.mode),n.on("change",function(e,t){i.val(n.getValue()).trigger("change")}),clearInterval(o)}})}})},e.fn.iocf_field_date=function(){return this.each(function(){var t=e(this),i=t.find("input"),n=t.find(".csf-date-settings").data("settings"),a={showAnim:"",beforeShow:function(t,i){e(i.dpDiv).addClass("csf-datepicker-wrapper")},onClose:function(t,i){e(i.dpDiv).removeClass("csf-datepicker-wrapper")}};n=e.extend({},n,a),2===i.length&&(n=e.extend({},n,{onSelect:function(t){var a=(e(this),i.first(),i.first().attr("id")===e(this).attr("id")?"minDate":"maxDate"),c=e.datepicker.parseDate(n.dateFormat,t);i.not(this).datepicker("option",a,c)}})),i.each(function(){var t=e(this);t.hasClass("hasDatepicker")&&t.removeAttr("id").removeClass("hasDatepicker"),t.datepicker(n)})})},e.fn.iocf_field_datetime=function(){return this.each(function(){var t=e(this),i=t.find("input"),n=t.find(".csf-datetime-settings").data("settings");n=e.extend({},n,{onReady:function(t,i,n){e(n.calendarContainer).addClass("csf-flatpickr")}}),2===i.length&&(n=e.extend({},n,{onChange:function(t,n,a){"from"===e(a.element).data("type")?i.last().get(0)._flatpickr.set("minDate",t[0]):i.first().get(0)._flatpickr.set("maxDate",t[0])}})),i.each(function(){e(this).flatpickr(n)})})},e.fn.iocf_field_fieldset=function(){return this.each(function(){e(this).find(".csf-fieldset-content").iocf_reload_script()})},e.fn.iocf_field_gallery=function(){return this.each(function(){var i,n=e(this),a=n.find(".csf-edit-gallery"),c=n.find(".csf-clear-gallery"),o=n.find("ul"),s=n.find("input");n.find("img");n.on("click",".csf-button, .csf-edit-gallery",function(n){var r=e(this),f=s.val(),l=r.hasClass("csf-edit-gallery")?"edit":"add",d="add"!==l||f.length?"gallery-edit":"gallery";n.preventDefault(),void 0!==t.wp&&t.wp.media&&t.wp.media.gallery&&("gallery"===d?(i=t.wp.media({library:{type:"image"},frame:"post",state:"gallery",multiple:!0}),i.open()):(i=t.wp.media.gallery.edit('[gallery ids="'+f+'"]'),"add"===l&&i.setState("gallery-library")),i.on("update",function(e){o.empty();var t=e.models.map(function(e){var t=e.toJSON(),i=t.sizes&&t.sizes.thumbnail&&t.sizes.thumbnail.url?t.sizes.thumbnail.url:t.url;return o.append('<li><img src="'+i+'"></li>'),t.id});s.val(t.join(",")).trigger("change"),c.removeClass("hidden"),a.removeClass("hidden")}))}),c.on("click",function(e){e.preventDefault(),o.empty(),s.val("").trigger("change"),c.addClass("hidden"),a.addClass("hidden")})})},e.fn.iocf_field_group=function(){return this.each(function(){var t=e(this),i=t.children(".csf-fieldset"),n=i.length?i:t,c=n.children(".csf-cloneable-wrapper"),o=n.children(".csf-cloneable-hidden"),s=n.children(".csf-cloneable-max"),r=n.children(".csf-cloneable-min"),f=c.data("title-by"),l=c.data("title-by-prefix"),d=c.data("field-id"),h=Boolean(Number(c.data("title-number"))),p=parseInt(c.data("max")),u=parseInt(c.data("min"));c.hasClass("ui-accordion")&&c.find(".ui-accordion-header-icon").remove();var v=function(t){t.find(".csf-cloneable-title-number").each(function(t){e(this).html(e(this).closest(".csf-cloneable-item").index()+1+".")})};c.accordion({header:"> .csf-cloneable-item > .csf-cloneable-title",collapsible:!0,active:!1,animate:!1,heightStyle:"content",icons:{header:"csf-cloneable-header-icon fas fa-angle-right",activeHeader:"csf-cloneable-header-icon fas fa-angle-down"},activate:function(t,i){var n=i.newPanel,a=i.newHeader;if(n.length&&!n.data("opened")){var c=a.find(".csf-cloneable-value"),o=[];e.each(f,function(e,t){o.push(n.find('[data-depend-id="'+t+'"]'))}),e.each(o,function(t,i){i.on("change keyup csf.keyup",function(){var t=[];e.each(o,function(i,n){var a=n.val(),c=n.attr("type");"radio"===c?a=n.filter(":checked").val():"checkbox"===c&&(a=n.filter(":checked").map(function(){return e(this).val()}).get().join(l)),a&&t.push(a)}),t.length&&c.text(t.join(l))}).trigger("csf.keyup")}),n.iocf_reload_script(),n.data("opened",!0),n.data("retry",!1)}else n.data("retry")&&(n.iocf_reload_script_retry(),n.data("retry",!1))}}),c.sortable({axis:"y",handle:".csf-cloneable-title,.csf-cloneable-sort",helper:"original",cursor:"move",placeholder:"widget-placeholder",start:function(e,t){c.accordion({active:!1}),c.sortable("refreshPositions"),t.item.children(".csf-cloneable-content").data("retry",!0)},update:function(e,t){a.helper.name_nested_replace(c.children(".csf-cloneable-item"),d),c.iocf_customizer_refresh(),h&&v(c)},disabled:t.hasClass("no-sort")}),n.children(".csf-cloneable-add").on("click",function(e){e.preventDefault();var t=c.children(".csf-cloneable-item").length;if(r.hide(),p&&t+1>p)return void s.show();var i=o.iocf_clone(!0);i.removeClass("csf-cloneable-hidden"),i.find(':input[name!="_pseudo"]').each(function(){this.name=this.name.replace("___","").replace(d+"[0]",d+"["+t+"]")});var n=i.find('input[name*="index"]');if(n[0]&&t>0){for(var a=c.find('.csf-cloneable-item input[name*="index"]'),f=-1/0,l=0;l<a.length;l++){var u=Number(a[l].value);isNaN(u)||(f=Math.max(f,u))}n.val(f+1)}c.append(i),c.accordion("refresh"),c.accordion({active:t}),c.iocf_customizer_refresh(),c.iocf_customizer_listen({closest:!0}),h&&v(c)});var g=function(t){t.preventDefault();var i=c.children(".csf-cloneable-item").length;if(r.hide(),p&&i+1>p)return void s.show();var n=e(this),o=n.parent().parent(),f=o.children(".csf-cloneable-helper").iocf_clone(!0),l=o.children(".csf-cloneable-title").iocf_clone(),u=o.children(".csf-cloneable-content").iocf_clone(),g=e('<div class="csf-cloneable-item" />');g.append(f),g.append(l),g.append(u),c.children().eq(o.index()).after(g),a.helper.name_nested_replace(c.children(".csf-cloneable-item"),d),c.accordion("refresh"),c.iocf_customizer_refresh(),c.iocf_customizer_listen({closest:!0}),h&&v(c)};c.children(".csf-cloneable-item").children(".csf-cloneable-helper").on("click",".csf-cloneable-clone",g),n.children(".csf-cloneable-hidden").children(".csf-cloneable-helper").on("click",".csf-cloneable-clone",g);var m=function(t){t.preventDefault();var i=c.children(".csf-cloneable-item").length;if(s.hide(),r.hide(),u&&i-1<u)return void r.show();e(this).closest(".csf-cloneable-item").remove(),a.helper.name_nested_replace(c.children(".csf-cloneable-item"),d),c.iocf_customizer_refresh(),h&&v(c)};c.children(".csf-cloneable-item").children(".csf-cloneable-helper").on("click",".csf-cloneable-remove",m),n.children(".csf-cloneable-hidden").children(".csf-cloneable-helper").on("click",".csf-cloneable-remove",m)})},e.fn.iocf_field_icon=function(){return this.each(function(){var i=e(this);i.on("click",".csf-icon-add",function(n){n.preventDefault();var c=e(this),o=e("#csf-modal-icon");o.removeClass("hidden"),a.vars.$icon_target=i,a.vars.icon_modal_loaded||(o.find(".csf-modal-loading").show(),t.wp.ajax.post("csf-get-icons",{nonce:c.data("nonce")}).done(function(t){o.find(".csf-modal-loading").hide(),a.vars.icon_modal_loaded=!0;var i=o.find(".csf-modal-load").html(t.content);i.on("click","i",function(t){t.preventDefault();var i=e(this).attr("title");a.vars.$icon_target.find(".csf-icon-preview i").removeAttr("class").addClass(i),a.vars.$icon_target.find(".csf-icon-preview").removeClass("hidden"),a.vars.$icon_target.find(".csf-icon-remove").removeClass("hidden"),a.vars.$icon_target.find("input").val(i).trigger("change"),o.addClass("hidden")}),o.on("change keyup",".csf-icon-search",function(){var t=e(this).val();i.find("i").each(function(){var i=e(this);i.attr("title").search(new RegExp(t,"i"))<0?i.hide():i.show()})}),o.on("click",".csf-modal-close, .csf-modal-overlay",function(){o.addClass("hidden")})}).fail(function(e){o.find(".csf-modal-loading").hide(),o.find(".csf-modal-load").html(e.error),o.on("click",function(){o.addClass("hidden")})}))}),i.on("click",".csf-icon-remove",function(t){t.preventDefault(),i.find(".csf-icon-preview").addClass("hidden"),i.find("input").val("").trigger("change"),e(this).addClass("hidden")})})},e.fn.iocf_field_map=function(){return this.each(function(){if("undefined"!=typeof L){var t=e(this),i=t.find(".csf--map-osm"),n=t.find(".csf--map-search input"),a=t.find(".csf--latitude"),c=t.find(".csf--longitude"),o=t.find(".csf--zoom"),s=i.data("map"),r=L.map(i.get(0),s);L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(r);var f=L.marker(s.center,{draggable:!0}).addTo(r),l=function(e){a.val(e.lat),c.val(e.lng),o.val(r.getZoom())};r.on("click",function(e){f.setLatLng(e.latlng),l(e.latlng)}),r.on("zoom",function(){l(f.getLatLng())}),f.on("drag",function(){l(f.getLatLng())}),n.length||(n=e('[data-depend-id="'+t.find(".csf--address-field").data("address-field")+'"]'));var d={};n.autocomplete({source:function(t,i){var n=t.term;if(n in d)return void i(d[n]);e.get("https://nominatim.openstreetmap.org/search",{format:"json",q:n},function(e){var t;t=e.length?e.map(function(e){return{value:e.display_name,label:e.display_name,lat:e.lat,lon:e.lon}},"json"):[{value:"no-data",label:"No Results."}],d[n]=t,i(t)})},select:function(e,t){if("no-data"===t.item.value)return!1;var i=L.latLng(t.item.lat,t.item.lon);r.panTo(i),f.setLatLng(i),l(i)},create:function(t,i){e(this).autocomplete("widget").addClass("csf-map-ui-autocomplate")}});var h=function(){var e=L.latLng(a.val(),c.val());r.panTo(e),f.setLatLng(e)};a.on("change",h),c.on("change",h)}})},e.fn.iocf_field_link=function(){return this.each(function(){var i=e(this),n=i.find(".csf--link"),c=i.find(".csf--add"),o=i.find(".csf--edit"),s=i.find(".csf--remove"),r=i.find(".csf--result"),f=a.helper.uid("csf-wplink-textarea-");c.on("click",function(e){e.preventDefault(),t.wpLink.open(f)}),o.on("click",function(t){t.preventDefault(),c.trigger("click"),e("#wp-link-url").val(i.find(".csf--url").val()),e("#wp-link-text").val(i.find(".csf--text").val()),e("#wp-link-target").prop("checked","_blank"===i.find(".csf--target").val())}),s.on("click",function(e){e.preventDefault(),i.find(".csf--url").val("").trigger("change"),i.find(".csf--text").val(""),i.find(".csf--target").val(""),c.removeClass("hidden"),o.addClass("hidden"),s.addClass("hidden"),r.parent().addClass("hidden")}),n.attr("id",f).on("change",function(){var n=t.wpLink.getAttrs();if(n&&n.href){var a=n.href,f=e("#wp-link-text").val(),l=n.target?n.target:"";e("#wp-link")[0].reset(),i.find(".csf--url").val(a).trigger("change"),i.find(".csf--text").val(f),i.find(".csf--target").val(l),r.html('{url:"'+a+'", text:"'+f+'", target:"'+l+'"}'),c.addClass("hidden"),o.removeClass("hidden"),s.removeClass("hidden"),r.parent().removeClass("hidden")}})})},e.fn.iocf_field_media=function(){return this.each(function(){var i,n=e(this),a=n.find(".csf--button"),c=n.find(".csf--remove"),o=a.data("library")&&a.data("library").split(",")||"",s=!!n.hasClass("csf-assign-field-background")&&n.closest(".csf-field-background").find(".csf--auto-attributes");a.on("click",function(e){if(e.preventDefault(),void 0!==t.wp&&t.wp.media&&t.wp.media.gallery){if(i)return void i.open();i=t.wp.media({library:{type:o}}),i.on("select",function(){var e,t=i.state().get("selection").first().attributes,r=a.data("preview-size")||"thumbnail";o.length&&-1===o.indexOf(t.subtype)&&-1===o.indexOf(t.type)||(n.find(".csf--id").val(t.id),n.find(".csf--width").val(t.width),n.find(".csf--height").val(t.height),n.find(".csf--alt").val(t.alt),n.find(".csf--title").val(t.title),n.find(".csf--description").val(t.description),e=void 0!==t.sizes&&void 0!==t.sizes.thumbnail&&"thumbnail"===r?t.sizes.thumbnail.url:void 0!==t.sizes&&void 0!==t.sizes.full?t.sizes.full.url:"image"===t.type?t.url:t.icon,s&&s.removeClass("csf--attributes-hidden"),c.removeClass("hidden"),n.find(".csf--preview").removeClass("hidden"),n.find(".csf--src").attr("src",e),n.find(".csf--thumbnail").val(e),n.find(".csf--url").val(t.url).trigger("change"))}),i.open()}}),c.on("click",function(e){e.preventDefault(),s&&s.addClass("csf--attributes-hidden"),c.addClass("hidden"),n.find("input").val(""),n.find(".csf--preview").addClass("hidden"),n.find(".csf--url").trigger("change")})})},e.fn.iocf_field_repeater=function(){return this.each(function(){var t=e(this),i=t.children(".csf-fieldset"),n=i.length?i:t,c=n.children(".csf-repeater-wrapper"),o=n.children(".csf-repeater-hidden"),s=n.children(".csf-repeater-max"),r=n.children(".csf-repeater-min"),f=c.data("field-id"),l=Boolean(Number(c.data("title-number"))),d=parseInt(c.data("max")),h=parseInt(c.data("min"));c.children(".csf-repeater-item").children(".csf-repeater-content").iocf_reload_script();var p=function(t){t.find(".csf-repeater-title-number").each(function(t){e(this).html(e(this).closest(".csf-repeater-item").index()+1)})};c.sortable({axis:"y",handle:".csf-repeater-helper",helper:"original",cursor:"move",placeholder:"widget-placeholder",update:function(e,t){a.helper.name_nested_replace(c.children(".csf-repeater-item"),f),c.iocf_customizer_refresh(),t.item.iocf_reload_script_retry(),l&&p(c)},start:function(e,t){var i=t.helper.outerHeight();t.placeholder.height(i)}}),n.children(".csf-repeater-add").on("click",function(e){e.preventDefault();var t=c.children(".csf-repeater-item").length;if(r.hide(),d&&t+1>d)return void s.show();var i=o.iocf_clone(!0);i.removeClass("csf-repeater-hidden"),i.find(':input[name!="_pseudo"]').each(function(){this.name=this.name.replace("___","").replace(f+"[0]",f+"["+t+"]")}),c.append(i),i.children(".csf-repeater-content").iocf_reload_script(),c.iocf_customizer_refresh(),c.iocf_customizer_listen({closest:!0}),l&&p(c)});var u=function(t){t.preventDefault();var i=c.children(".csf-repeater-item").length;if(r.hide(),d&&i+1>d)return void s.show();var n=e(this),o=n.parent().parent().parent(),h=o.children(".csf-repeater-content").iocf_clone(),u=o.children(".csf-repeater-helper").iocf_clone(!0),v=e('<div class="csf-repeater-item" />');v.append(h),v.append(u),c.children().eq(o.index()).after(v),v.children(".csf-repeater-content").iocf_reload_script(),a.helper.name_nested_replace(c.children(".csf-repeater-item"),f),c.iocf_customizer_refresh(),c.iocf_customizer_listen({closest:!0}),l&&p(c)};c.children(".csf-repeater-item").children(".csf-repeater-helper").on("click",".csf-repeater-clone",u),n.children(".csf-repeater-hidden").children(".csf-repeater-helper").on("click",".csf-repeater-clone",u);var v=function(t){t.preventDefault();var i=c.children(".csf-repeater-item").length;if(s.hide(),r.hide(),h&&i-1<h)return void r.show();e(this).closest(".csf-repeater-item").remove(),a.helper.name_nested_replace(c.children(".csf-repeater-item"),f),c.iocf_customizer_refresh(),l&&p(c)};c.children(".csf-repeater-item").children(".csf-repeater-helper").on("click",".csf-repeater-remove",v),n.children(".csf-repeater-hidden").children(".csf-repeater-helper").on("click",".csf-repeater-remove",v)})},e.fn.iocf_field_slider=function(){return this.each(function(){var t=e(this),i=t.find("input"),n=t.find(".csf-slider-ui"),a=i.data(),c=i.val()||0;n.hasClass("ui-slider")&&n.empty(),n.slider({range:"min",value:c,min:a.min||0,max:a.max||100,step:a.step||1,slide:function(e,t){i.val(t.value).trigger("change")}}),i.on("keyup",function(){n.slider("value",i.val())})})},e.fn.iocf_field_sortable=function(){return this.each(function(){var t=e(this).find(".csf-sortable");t.sortable({axis:"y",helper:"original",cursor:"move",placeholder:"widget-placeholder",update:function(e,i){t.iocf_customizer_refresh()}}),t.find(".csf-sortable-content").iocf_reload_script()})},e.fn.iocf_field_sorter=function(){return this.each(function(){var t=e(this),i=t.find(".csf-enabled"),n=t.find(".csf-disabled"),a=!!n.length&&n;i.sortable({connectWith:a,placeholder:"ui-sortable-placeholder",update:function(e,i){var n=i.item.find("input");i.item.parent().hasClass("csf-enabled")?n.attr("name",n.attr("name").replace("disabled","enabled")):n.attr("name",n.attr("name").replace("enabled","disabled")),t.iocf_customizer_refresh()}}),a&&a.sortable({connectWith:i,placeholder:"ui-sortable-placeholder",update:function(e,i){t.iocf_customizer_refresh()}})})},e.fn.iocf_field_spinner=function(){return this.each(function(){var t=e(this),i=t.find("input"),n=t.find(".ui-button"),a=i.data();n.length&&n.remove(),i.spinner({min:a.min||0,max:a.max||100,step:a.step||1,create:function(e,t){a.unit&&i.after('<span class="ui-button csf--unit">'+a.unit+"</span>")},spin:function(e,t){i.val(t.value).trigger("change")}})})},e.fn.iocf_field_switcher=function(){return this.each(function(){var t=e(this).find(".csf--switcher");t.on("click",function(){var e=0,i=t.find("input");t.hasClass("csf--active")?t.removeClass("csf--active"):(e=1,t.addClass("csf--active")),i.val(e).trigger("change")})})},e.fn.iocf_field_tabbed=function(){return this.each(function(){var t=e(this),i=t.find(".csf-tabbed-nav a"),n=t.find(".csf-tabbed-content");n.eq(0).iocf_reload_script(),i.on("click",function(t){t.preventDefault();var i=e(this),a=i.index(),c=n.eq(a);i.addClass("csf-tabbed-active").siblings().removeClass("csf-tabbed-active"),c.iocf_reload_script(),c.removeClass("hidden").siblings().addClass("hidden")})})},e.fn.iocf_field_typography=function(){return this.each(function(){var t=this,i=e(this),n=[],c=iocf_typography_json.webfonts,o=iocf_typography_json.googlestyles,s=iocf_typography_json.defaultstyles;t.sanitize_subset=function(e){return e=e.replace("-ext"," Extended"),e=e.charAt(0).toUpperCase()+e.slice(1)},t.sanitize_style=function(e){return o[e]?o[e]:e},t.load_google_font=function(e,t,i){e&&"object"===("undefined"==typeof WebFont?"undefined":_typeof(WebFont))&&(t=t?t.replace("normal",""):"",i=i?i.replace("normal",""):"",(t||i)&&(e=e+":"+t+i),-1===n.indexOf(e)&&WebFont.load({google:{families:[e]}}),n.push(e))},t.append_select_options=function(i,n,a,c,o){i.find("option").not(":first").remove();var s="";e.each(n,function(e,i){var n,r=i;n=o?a&&-1!==a.indexOf(i)?" selected":"":a&&a===i?" selected":"","subset"===c?r=t.sanitize_subset(i):"style"===c&&(r=t.sanitize_style(i)),s+='<option value="'+i+'"'+n+">"+r+"</option>"}),i.append(s).trigger("csf.change").trigger("chosen:updated")},t.init=function(){var n=[],o=i.find(".csf--typography"),r=i.find(".csf--type"),f=i.find(".csf--block-font-style"),l=o.data("unit"),d=o.data("line-height-unit"),h=o.data("exclude")?o.data("exclude").split(","):[];if(i.find(".csf--chosen").length){i.find("select").each(function(){var t=e(this),i=t.parent().find(".chosen-container");i.length&&i.remove(),t.chosen({allow_single_deselect:!0,disable_search_threshold:15,width:"100%"})})}var p=i.find(".csf--font-family"),u=p.val();p.find("option").not(":first-child").remove();var v="";e.each(c,function(t,i){h&&-1!==h.indexOf(t)||(v+='<optgroup label="'+i.label+'">',e.each(i.fonts,function(e,i){i="object"===(void 0===i?"undefined":_typeof(i))?e:i,v+='<option value="'+i+'" data-type="'+t+'"'+(i===u?" selected":"")+">"+i+"</option>"}),v+="</optgroup>")}),p.append(v).trigger("chosen:updated");var g=i.find(".csf--block-font-style");if(g.length){var m=i.find(".csf--font-style-select"),_=m.val()?m.val().replace(/normal/g,""):"";m.on("change csf.change",function(e){var t=m.val();!t&&n&&-1===n.indexOf("normal")&&(t=n[0]);var a=t&&"italic"!==t&&"normal"===t?"normal":"",c=t&&"italic"!==t&&"normal"!==t?t.replace("italic",""):a,o=t&&"italic"===t.substr(-6)?"italic":"";i.find(".csf--font-weight").val(c),i.find(".csf--font-style").val(o)});var b=i.find(".csf--block-extra-styles");if(b.length)var y=i.find(".csf--extra-styles"),w=y.val()}var C=i.find(".csf--block-subset");if(C.length)var k=i.find(".csf--subset"),x=k.val(),z=k.data("multiple")||!1;var O=i.find(".csf--block-backup-font-family");p.on("change csf.change",function(e){C.length&&C.addClass("hidden"),b.length&&b.addClass("hidden"),O.length&&O.addClass("hidden");var i=p.find(":selected"),a=i.val(),o=i.data("type");if(o&&a){if("google"!==o&&"custom"!==o||!O.length||O.removeClass("hidden"),g.length){var l=s;"google"===o&&c[o].fonts[a][0]?l=c[o].fonts[a][0]:"custom"===o&&c[o].fonts[a]&&(l=c[o].fonts[a]),n=l;var d=-1!==l.indexOf("normal")?"normal":l[0],h=_&&-1!==l.indexOf(_)?_:d;t.append_select_options(m,l,h,"style"),_=!1,g.removeClass("hidden"),"google"===o&&b.length&&l.length>1&&(t.append_select_options(y,l,w,"style",!0),w=!1,b.removeClass("hidden"))}if("google"===o&&C.length&&c[o].fonts[a][1]){var u=c[o].fonts[a][1],v=u.length<2&&"latin"!==u[0]?u[0]:"",D=x&&-1!==u.indexOf(x)?x:v;D=z&&x?x:D,t.append_select_options(k,u,D,"subset",z),x=!1,C.removeClass("hidden")}}else f.find(":input").val(""),C.length&&(k.find("option").not(":first-child").remove(),k.trigger("chosen:updated")),g.length&&(m.find("option").not(":first-child").remove(),m.trigger("chosen:updated"));r.val(o)}).trigger("csf.change");var D=i.find(".csf--block-preview");if(D.length){var j=i.find(".csf--preview");i.on("change",a.helper.debounce(function(e){D.removeClass("hidden");var n=p.val(),a=i.find(".csf--font-weight").val(),c=i.find(".csf--font-style").val(),o=i.find(".csf--font-size").val(),s=i.find(".csf--font-variant").val(),r=i.find(".csf--line-height").val(),f=i.find(".csf--text-align").val(),h=i.find(".csf--text-transform").val(),u=i.find(".csf--text-decoration").val(),v=i.find(".csf--color").val(),g=i.find(".csf--word-spacing").val(),m=i.find(".csf--letter-spacing").val(),_=i.find(".csf--custom-style").val();"google"===i.find(".csf--type").val()&&t.load_google_font(n,a,c);var b={};n&&(b.fontFamily=n),a&&(b.fontWeight=a),c&&(b.fontStyle=c),s&&(b.fontVariant=s),o&&(b.fontSize=o+l),r&&(b.lineHeight=r+d),m&&(b.letterSpacing=m+l),g&&(b.wordSpacing=g+l),f&&(b.textAlign=f),h&&(b.textTransform=h),u&&(b.textDecoration=u),v&&(b.color=v),j.removeAttr("style"),_&&j.attr("style",_),j.css(b)},100)),D.on("click",function(){j.toggleClass("csf--black-background");var e=D.find(".csf--toggle");e.hasClass("fa-toggle-off")?e.removeClass("fa-toggle-off").addClass("fa-toggle-on"):e.removeClass("fa-toggle-on").addClass("fa-toggle-off")}),D.hasClass("hidden")||i.trigger("change")}},t.init()})},e.fn.iocf_field_upload=function(){return this.each(function(){var i,n=e(this),a=n.find("input"),c=n.find(".csf--button"),o=n.find(".csf--remove"),s=n.find(".csf--preview"),r=n.find(".csf--src"),f=c.data("library")&&c.data("library").split(",")||"";c.on("click",function(e){if(e.preventDefault(),void 0!==t.wp&&t.wp.media&&t.wp.media.gallery){if(i)return void i.open();i=t.wp.media({library:{type:f}}),i.on("select",function(){var e=i.state().get("selection").first().attributes;f.length&&-1===f.indexOf(e.subtype)&&-1===f.indexOf(e.type)||a.val(e.url).trigger("change")}),i.open()}}),o.on("click",function(e){e.preventDefault(),a.val("").trigger("change")}),a.on("change",function(t){var i=a.val();i?o.removeClass("hidden"):o.addClass("hidden"),s.length&&(-1!==e.inArray(i.split(".").pop().toLowerCase(),["jpg","jpeg","gif","png","svg","webp"])?(s.removeClass("hidden"),r.attr("src",i)):s.addClass("hidden"))})})},e.fn.iocf_field_wp_editor=function(){return this.each(function(){if(void 0!==t.wp.editor&&void 0!==t.tinyMCEPreInit&&void 0!==t.tinyMCEPreInit.mceInit.iocf_wp_editor){var i=e(this),n=i.find(".csf-wp-editor"),c=i.find("textarea");(i.find(".wp-editor-wrap").length||i.find(".mce-container").length)&&(n.empty(),n.append(c),c.css("display",""));var o=a.helper.uid("csf-editor-");c.attr("id",o);var s={tinymce:t.tinyMCEPreInit.mceInit.iocf_wp_editor,quicktags:t.tinyMCEPreInit.qtInit.iocf_wp_editor},r=n.data("editor-settings"),f=wp.oldEditor?wp.oldEditor:wp.editor;f&&f.hasOwnProperty("autop")&&(wp.editor.autop=f.autop,wp.editor.removep=f.removep,wp.editor.initialize=f.initialize);var l=function(e){e.on("change keyup",function(){var t=r.wpautop?e.getContent():wp.editor.removep(e.getContent());c.val(t).trigger("change")})};s.tinymce=e.extend({},s.tinymce,{selector:"#"+o,setup:l}),!1===r.tinymce&&(s.tinymce=!1,n.addClass("csf-no-tinymce")),!1===r.quicktags&&(s.quicktags=!1,n.addClass("csf-no-quicktags"));var d=setInterval(function(){i.is(":visible")&&(t.wp.editor.initialize(o,s),clearInterval(d))});if(r.media_buttons&&t.iocf_media_buttons){var h=n.find(".wp-media-buttons");if(h.length)h.find(".csf-shortcode-button").data("editor-id",o);else{var p=e(t.iocf_media_buttons);p.find(".csf-shortcode-button").data("editor-id",o),n.prepend(p)}}}})},e.fn.iocf_confirm=function(){return this.each(function(){e(this).on("click",function(i){var n=e(this).data("confirm")||t.iocf_vars.i18n.confirm;if(!confirm(n))return i.preventDefault(),!1;a.vars.is_confirm=!0,a.vars.form_modified=!1})})},e.fn.serializeObject=function(){var t={};return e.each(this.serializeArray(),function(i,n){var a=n.name,c=n.value;t[a]=void 0===t[a]?c:e.isArray(t[a])?t[a].concat(c):[t[a],c]}),t},e.fn.iocf_save=function(){return this.each(function(){var i,n=e(this),c=e(".csf-save"),o=e(".csf-options"),s=!1;n.on("click",function(r){if(!s){var f=n.data("save"),l=n.val();c.attr("value",f),n.hasClass("csf-save-ajax")?(r.preventDefault(),o.addClass("csf-saving"),c.prop("disabled",!0),t.wp.ajax.post("iocf_"+o.data("unique")+"_ajax_save",{data:e("#csf-form").serializeJSONIOCF()}).done(function(t){if(e(".csf-error").remove(),Object.keys(t.errors).length){var n='<i class="csf-label-error csf-error">!</i>';e.each(t.errors,function(t,i){var a=e('[data-depend-id="'+t+'"]'),c=e('a[href="#tab='+a.closest(".csf-section").data("section-id")+'"]'),o=c.closest(".csf-tab-item");a.closest(".csf-fieldset").append('<p class="csf-error csf-error-text">'+i+"</p>"),c.find(".csf-error").length||c.append(n),o.find(".csf-arrow .csf-error").length||o.find(".csf-arrow").append(n)})}o.removeClass("csf-saving"),c.prop("disabled",!1).attr("value",l),s=!1,a.vars.form_modified=!1,a.vars.$form_warning.hide(),clearTimeout(i);var r=e(".csf-form-success");r.empty().append(t.notice).fadeIn("fast",function(){i=setTimeout(function(){r.fadeOut("fast")},1e3)})}).fail(function(e){alert(e.error)})):a.vars.form_modified=!1}s=!0})})},e.fn.iocf_options=function(){return this.each(function(){var n=e(this),c=n.find(".csf-content"),o=n.find(".csf-form-success"),s=n.find(".csf-form-warning"),r=n.find(".csf-header .csf-save");a.vars.$form_warning=s,s.length&&(t.onbeforeunload=function(){return!!a.vars.form_modified||void 0},c.on("change keypress",":input:not(.not-change)",function(){a.vars.form_modified||(o.hide(),s.fadeIn("fast"),a.vars.form_modified=!0)})),o.hasClass("csf-form-show")&&setTimeout(function(){o.fadeOut("fast")},1e3),e(i).keydown(function(e){if((e.ctrlKey||e.metaKey)&&83===e.which)return r.trigger("click"),e.preventDefault(),!1})})},e.fn.iocf_taxonomy=function(){return this.each(function(){var t=e(this),i=t.parents("form");if("addtag"===i.attr("id")){var n=i.find("#submit"),a=t.children(".csf-field").iocf_clone();n.on("click",function(){i.find(".form-required").hasClass("form-invalid")||(t.data("inited",!1),t.empty(),t.html(a),a=a.iocf_clone(),t.iocf_reload_script())})}})},e.fn.iocf_shortcode=function(){var n=this;return n.shortcode_parse=function(t,i){var a="";return e.each(t,function(t,c){i=i||t,a+="["+i,e.each(c,function(e,t){"content"===e?(a+="]",a+=t,a+="[/"+i):a+=n.shortcode_tags(e,t)}),a+="]"}),a},n.shortcode_tags=function(t,i){var n="";return""!==i&&("object"!==(void 0===i?"undefined":_typeof(i))||e.isArray(i)?n+=" "+t+'="'+i.toString()+'"':e.each(i,function(e,t){switch(e){case"background-image":t=t.url?t.url:""}""!==t&&(n+=" "+e+'="'+t.toString()+'"')})),n},n.insertAtChars=function(e,t){var i=void 0!==e[0].name?e[0]:e;return i.value.length&&void 0!==i.selectionStart?(i.focus(),i.value.substring(0,i.selectionStart)+t+i.value.substring(i.selectionEnd,i.value.length)):(i.focus(),t)},n.send_to_editor=function(t,i){var a;if("undefined"!=typeof tinymce&&(a=tinymce.get(i)),a&&!a.isHidden())a.execCommand("mceInsertContent",!1,t);else{var c=e("#"+i);c.val(n.insertAtChars(c,t)).trigger("change")}},this.each(function(){var c,o,s,r,f,l,d,h,p,u=e(this),v=u.find(".csf-modal-load"),g=(u.find(".csf-modal-content"),u.find(".csf-modal-insert")),m=u.find(".csf-modal-loading"),_=u.find("select"),b=u.data("modal-id"),y=u.data("nonce");e(i).on("click",'.csf-shortcode-button[data-modal-id="'+b+'"]',function(t){t.preventDefault(),p=e(this),c=p.data("editor-id")||!1,o=p.data("target-id")||!1,s=p.data("gutenberg-id")||!1,u.removeClass("hidden"),u.hasClass("csf-shortcode-single")&&void 0===f&&_.trigger("change")}),_.on("change",function(){var i=e(this),n=i.find(":selected");r=i.val(),f=n.data("shortcode"),l=n.data("view")||"normal",d=n.data("group")||f,v.empty(),r?(m.show(),t.wp.ajax.post("csf-get-shortcode-"+b,{shortcode_key:r,nonce:y}).done(function(t){m.hide();var i=e(t.content).appendTo(v);g.parent().removeClass("hidden"),h=i.find(".csf--repeat-shortcode").iocf_clone(),i.iocf_reload_script(),i.find(".csf-fields").iocf_reload_script()})):g.parent().addClass("hidden")}),g.on("click",function(i){if(i.preventDefault(),!g.prop("disabled")&&!g.attr("disabled")){var a="",r=u.find(".csf-field:not(.csf-depend-on)").find(":input:not(.ignore)").serializeObjectIOCF();switch(l){case"contents":var h=f?r[f]:r;e.each(h,function(e,t){var i=f||e;a+="["+i+"]"+t+"[/"+i+"]"});break;case"group":a+="["+f,e.each(r[f],function(e,t){a+=n.shortcode_tags(e,t)}),a+="]",a+=n.shortcode_parse(r[d],d),a+="[/"+f+"]";break;case"repeater":a+=n.shortcode_parse(r[d],d);break;default:a+=n.shortcode_parse(r)}if(a=""===a?"["+f+"]":a,s){var v=t.iocf_gutenberg_props.attributes.hasOwnProperty("shortcode")?t.iocf_gutenberg_props.attributes.shortcode:"";t.iocf_gutenberg_props.setAttributes({shortcode:v+a})}else if(c)n.send_to_editor(a,c);else{var m=o?e(o):p.parent().find("textarea");m.val(n.insertAtChars(m,a)).trigger("change")}u.addClass("hidden")}}),u.on("click",".csf--repeat-button",function(e){e.preventDefault();var t=u.find(".csf--repeatable"),i=h.iocf_clone(),n=i.find(".csf-repeat-remove");i.appendTo(t);i.find(".csf-fields").iocf_reload_script(),a.helper.name_nested_replace(u.find(".csf--repeat-shortcode"),d),n.on("click",function(){i.remove(),a.helper.name_nested_replace(u.find(".csf--repeat-shortcode"),d)})}),u.on("click",".csf-modal-close, .csf-modal-overlay",function(){u.addClass("hidden")})})},"function"==typeof Color&&(Color.prototype.toString=function(){if(this._alpha<1)return this.toCSS("rgba",this._alpha).replace(/\s+/g,"");var e=parseInt(this._color,10).toString(16);if(this.error)return"";if(e.length<6)for(var t=6-e.length-1;t>=0;t--)e="0"+e;return"#"+e}),a.funcs.parse_color=function(e){var t=e.replace(/\s+/g,""),i=-1!==t.indexOf("rgba")?parseFloat(100*t.replace(/^.*,(.+)\)/,"$1")):100;return{value:t,transparent:i,rgba:i<100}},e.fn.iocf_color=function(){return this.each(function(){var i,n=e(this),c=a.funcs.parse_color(n.val()),o=!t.iocf_vars.color_palette.length||t.iocf_vars.color_palette;n.hasClass("wp-color-picker")&&n.closest(".wp-picker-container").after(n).remove(),n.wpColorPicker({palettes:o,change:function(e,t){var a=t.color.toString();i.removeClass("csf--transparent-active"),i.find(".csf--transparent-offset").css("background-color",a),n.val(a).trigger("change")},create:function(){i=n.closest(".wp-picker-container");var t=n.data("a8cIris"),o=e('<div class="csf--transparent-wrap"><div class="csf--transparent-slider"></div><div class="csf--transparent-offset"></div><div class="csf--transparent-text"></div><div class="csf--transparent-button">transparent <i class="fas fa-toggle-off"></i></div></div>').appendTo(i.find(".wp-picker-holder")),s=o.find(".csf--transparent-slider"),r=o.find(".csf--transparent-text"),f=o.find(".csf--transparent-offset"),l=o.find(".csf--transparent-button");"transparent"===n.val()&&i.addClass("csf--transparent-active"),l.on("click",function(){"transparent"!==n.val()?(n.val("transparent").trigger("change").removeClass("iris-error"),i.addClass("csf--transparent-active")):(n.val(t._color.toString()).trigger("change"),i.removeClass("csf--transparent-active"))}),s.slider({value:c.transparent,step:1,min:0,max:100,slide:function(e,i){var a=parseFloat(i.value/100);t._color._alpha=a,n.wpColorPicker("color",t._color.toString()),r.text(1===a||0===a?"":a)},create:function(){var e=parseFloat(c.transparent/100),o=e<1?e:"";r.text(o),f.css("background-color",c.value),i.on("click",".wp-picker-clear",function(){t._color._alpha=1,r.text(""),s.slider("option","value",100),i.removeClass("csf--transparent-active"),n.trigger("change")}),i.on("click",".wp-picker-default",function(){var e=a.funcs.parse_color(n.data("default-color")),c=parseFloat(e.transparent/100),o=c<1?c:"";t._color._alpha=c,r.text(o),s.slider("option","value",e.transparent),"transparent"===e.value&&(n.removeClass("iris-error"),i.addClass("csf--transparent-active"))})}})}})})},e.fn.iocf_chosen=function(){return this.each(function(){var i=e(this),n=i.parent().find(".chosen-container"),a=i.hasClass("csf-chosen-sortable")||!1,c=i.hasClass("csf-chosen-ajax")||!1,o=i.attr("multiple")||!1,s=o?"100%":"auto",r=e.extend({allow_single_deselect:!0,disable_search_threshold:10,width:s,no_results_text:t.iocf_vars.i18n.no_results_text},i.data("chosen-settings"));if(n.length&&n.remove(),c){var f=e.extend({data:{type:"post",nonce:""},allow_single_deselect:!0,disable_search_threshold:-1,width:"100%",min_length:2,type_delay:500,typing_text:t.iocf_vars.i18n.typing_text,searching_text:t.iocf_vars.i18n.searching_text,no_results_text:t.iocf_vars.i18n.no_results_text},i.data("chosen-settings"));i.IOCFAjaxChosen(f)}else i.chosen(r);if(o){var l=i.parent().find(".csf-hide-select"),d=l.val()||[];i.on("change",function(e,i){i&&i.selected?l.append('<option value="'+i.selected+'" selected="selected">'+i.selected+"</option>"):i&&i.deselected&&l.find('option[value="'+i.deselected+'"]').remove(),void 0!==t.wp.customize&&0===l.children().length&&l.data("customize-setting-link")&&t.wp.customize.control(l.data("customize-setting-link")).setting.set(""),l.trigger("change")}),i.IOCFChosenOrder(d,!0)}if(a){var h=i.parent().find(".chosen-container"),p=h.find(".chosen-choices");p.bind("mousedown",function(t){e(t.target).is("span")&&t.stopPropagation()}),p.sortable({items:"li:not(.search-field)",helper:"orginal",cursor:"move",placeholder:"search-choice-placeholder",start:function(e,t){t.placeholder.width(t.item.innerWidth()),t.placeholder.height(t.item.innerHeight())},update:function(t,n){var a="",c=i.data("chosen"),o=i.parent().find(".csf-hide-select");p.find(".search-choice-close").each(function(){var t=e(this).data("option-array-index");e.each(c.results_data,function(e,i){i.array_index===t&&(a+='<option value="'+i.value+'" selected>'+i.value+"</option>")})}),o.children().remove(),o.append(a),o.trigger("change")}})}})},e.fn.iocf_checkbox=function(){return this.each(function(){var t=e(this),i=t.find(".csf--input"),n=t.find(".csf--checkbox");n.on("click",function(){i.val(Number(n.prop("checked"))).trigger("change")})})},e.fn.iocf_checkbox_all=function(){return this.each(function(){var t=e(this);t.on("click",function(){var i=t.closest(".csf-field-checkbox").find(":input"),n=!1;i.each(function(){e(this).prop("checked")||(n=!0)}),n?(i.prop("checked","checked"),i.attr("checked","checked")):(i.prop("checked",""),i.removeAttr("checked")),i.first().trigger("change")})})},e.fn.iocf_siblings=function(){return this.each(function(){var t=e(this),i=t.find(".csf--sibling"),n=t.data("multiple")||!1;i.on("click",function(){var i=e(this);n?i.hasClass("csf--active")?(i.removeClass("csf--active"),i.find("input").prop("checked",!1).trigger("change")):(i.addClass("csf--active"),i.find("input").prop("checked",!0).trigger("change")):(t.find("input").prop("checked",!1),i.find("input").prop("checked",!0).trigger("change"),i.addClass("csf--active").siblings().removeClass("csf--active"))})})},e.fn.iocf_help=function(){return this.each(function(){var t,i,n=e(this);n.on({mouseenter:function(){t=e('<div class="csf-tooltip"></div>').html(n.find(".csf-help-text").html()).appendTo("body"),i=a.vars.is_rtl?n.offset().left+24:n.offset().left-t.outerWidth(),t.css({top:n.offset().top-(t.outerHeight()/2-14),left:i})},mouseleave:function(){void 0!==t&&t.remove()}})})},e.fn.iocf_customizer_refresh=function(){return this.each(function(){var n=e(this),a=n.closest(".csf-customize-complex");if(a.length){var c=a.data("unique-id");if(void 0===c)return;var o=a.find(":input"),s=a.data("option-id"),r=o.serializeObjectIOCF(),f=!e.isEmptyObject(r)&&r[c]&&r[c][s]?r[c][s]:"",l=t.wp.customize.control(c+"["+s+"]");l.setting._value=null,l.setting.set(f)}else n.find(":input").first().trigger("change");e(i).trigger("csf-customizer-refresh",n)})},e.fn.iocf_customizer_listen=function(i){var n=e.extend({closest:!1},i);return this.each(function(){if(void 0!==t.wp.customize){var i=n.closest?e(this).closest(".csf-customize-complex"):e(this),a=i.find(":input"),c=i.data("unique-id"),o=i.data("option-id");void 0!==c&&a.on("change keyup csf.change",function(){var n=i.find(":input").serializeObjectIOCF(),a=!e.isEmptyObject(n)&&n[c]&&n[c][o]?n[c][o]:"";t.wp.customize.control(c+"["+o+"]").setting.set(a)})}})},e(i).on("expanded",".control-section",function(){var t=e(this);if(t.hasClass("open")&&!t.data("inited")){var i=t.find(".csf-customize-field"),n=t.find(".csf-customize-complex");i.length&&(t.iocf_dependency(),i.iocf_reload_script({dependency:!1}),n.iocf_customizer_listen()),t.data("inited",!0)}}),a.vars.$window.on("resize csf.resize",a.helper.debounce(function(i){(navigator.userAgent.indexOf("AppleWebKit/")>-1?a.vars.$window.width():t.innerWidth)<=782&&!a.vars.onloaded&&(e(".csf-section").iocf_reload_script(),a.vars.onloaded=!0)},200)).trigger("csf.resize"),e.fn.iocf_widgets=function(){return this.each(function(){e(i).on("widget-added widget-updated",function(e,t){var i=t.find(".csf-fields");i.length&&i.iocf_reload_script()}),e(i).on("click",".widget-top",function(t){var i=e(this).parent().find(".csf-fields");i.length&&i.iocf_reload_script()}),e(".widgets-sortables, .control-section-sidebar").on("sortstop",function(e,t){t.item.find(".csf-fields").iocf_reload_script_retry()})})},e.fn.iocf_nav_menu=function(){return this.each(function(){var t=e(this);t.on("click","a.item-edit",function(){e(this).closest("li.menu-item").find(".csf-fields").iocf_reload_script()}),t.on("sortstop",function(e,t){t.item.find(".csf-fields").iocf_reload_script_retry()})})},e.fn.iocf_reload_script_retry=function(){return this.each(function(){var t=e(this);t.data("inited")&&t.children(".csf-field-wp_editor").iocf_field_wp_editor()})},e.fn.iocf_reload_script=function(t){var n=e.extend({dependency:!0},t);return this.each(function(){var t=e(this);t.data("inited")||(t.children(".csf-field-accordion").iocf_field_accordion(),t.children(".csf-field-backup").iocf_field_backup(),t.children(".csf-field-background").iocf_field_background(),t.children(".csf-field-code_editor").iocf_field_code_editor(),t.children(".csf-field-date").iocf_field_date(),t.children(".csf-field-datetime").iocf_field_datetime(),t.children(".csf-field-fieldset").iocf_field_fieldset(),t.children(".csf-field-gallery").iocf_field_gallery(),t.children(".csf-field-group").iocf_field_group(),t.children(".csf-field-icon").iocf_field_icon(),t.children(".csf-field-link").iocf_field_link(),t.children(".csf-field-media").iocf_field_media(),t.children(".csf-field-map").iocf_field_map(),t.children(".csf-field-repeater").iocf_field_repeater(),t.children(".csf-field-slider").iocf_field_slider(),t.children(".csf-field-sortable").iocf_field_sortable(),t.children(".csf-field-sorter").iocf_field_sorter(),t.children(".csf-field-spinner").iocf_field_spinner(),t.children(".csf-field-switcher").iocf_field_switcher(),t.children(".csf-field-tabbed").iocf_field_tabbed(),t.children(".csf-field-typography").iocf_field_typography(),t.children(".csf-field-upload").iocf_field_upload(),t.children(".csf-field-wp_editor").iocf_field_wp_editor(),t.children(".csf-field-border").find(".csf-color").iocf_color(),t.children(".csf-field-background").find(".csf-color").iocf_color(),t.children(".csf-field-color").find(".csf-color").iocf_color(),t.children(".csf-field-color_group").find(".csf-color").iocf_color(),t.children(".csf-field-link_color").find(".csf-color").iocf_color(),t.children(".csf-field-typography").find(".csf-color").iocf_color(),t.children(".csf-field-select").find(".csf-chosen").iocf_chosen(),t.children(".csf-field-checkbox").find(".csf-checkbox").iocf_checkbox(),t.children(".csf-field-checkbox").find(".csf-checkbox-all").iocf_checkbox_all(),t.children(".csf-field-button_set").find(".csf-siblings").iocf_siblings(),t.children(".csf-field-image_select").find(".csf-siblings").iocf_siblings(),t.children(".csf-field-palette").find(".csf-siblings").iocf_siblings(),t.children(".csf-field").find(".csf-help").iocf_help(),n.dependency&&t.iocf_dependency(),t.data("inited",!0),e(i).trigger("csf-reload-script",t))})},e(i).ready(function(){e(".csf-save").iocf_save(),e(".csf-options").iocf_options(),e(".csf-sticky-header").iocf_sticky(),e(".csf-nav-options").iocf_nav_options(),e(".csf-nav-metabox").iocf_nav_metabox(),e(".csf-taxonomy").iocf_taxonomy(),e(".csf-page-templates").iocf_page_templates(),e(".csf-post-formats").iocf_post_formats(),e(".csf-shortcode").iocf_shortcode(),e(".csf-search").iocf_search(),e(".csf-confirm").iocf_confirm(),e(".csf-expand-all").iocf_expand_all(),e(".csf-onload").iocf_reload_script(),e("#widgets-editor").iocf_widgets(),e("#widgets-right").iocf_widgets(),e("#menu-to-edit").iocf_nav_menu()})}(jQuery,window,document);